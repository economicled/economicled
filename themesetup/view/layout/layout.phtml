<?php
/**
 * Copyright Â© 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */
?>
<?php echo $this->doctype(); ?>
<!--[if IE 9]>
<html class="ie9" lang="en" ng-app="magentoSetup"><![endif]-->
<!--[if !IE]><!-->
<html lang="en" ng-app="magentoSetup">
<!--<![endif]-->
<head>
<?php 
    $data = require(BP.'/app/etc/env.php');
	$baseUrl = $this->basePath();
	$baseUrl = str_replace('themesetup','setup',$baseUrl);
    $objectManager = \Magento\Framework\App\ObjectManager::getInstance();
    $meta = $objectManager->get('\Magento\Framework\App\ProductMetadata');
?>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{$state.current.title}}</title>
    <?php echo $this->headLink()
        ->appendStylesheet($baseUrl . '/pub/styles/setup.css');
    ?>
    <?php if($meta->getVersion() < '2.2.0'): ?>
    <?php echo $this->headScript()
        ->appendFile($baseUrl . '/pub/angular/angular.min.js')
        ->appendFile($baseUrl . '/pub/angular-ng-storage/angular-ng-storage.min.js')
        ->appendFile($baseUrl . '/pub/angular-ng-dialog/angular-ng-dialog.min.js')
        ->appendFile($baseUrl . '/pub/angular-clickout/angular-clickout.min.js')
        ->appendFile($baseUrl . '/pub/angular-ui-router/angular-ui-router.min.js')
        ->appendFile($baseUrl . '/pub/angular-ui-bootstrap/angular-ui-bootstrap.min.js')
        ->appendFile($baseUrl . '/pub/angular-sanitize/angular-sanitize.min.js')
        ->appendFile($baseUrl . '/pub/magento/setup/app.js')
        ->appendFile($baseUrl . '/pub/magento/setup/main.js')
        ->appendFile($baseUrl . '/pub/magento/setup/landing.js')
        ->appendFile($baseUrl . '/pub/magento/setup/component-grid.js')
        ->appendFile($baseUrl . '/pub/magento/setup/readiness-check.js')
        ->appendFile($baseUrl . '/pub/magento/setup/add-database.js')
        ->appendFile($baseUrl . '/pub/magento/setup/web-configuration.js')
        ->appendFile($baseUrl . '/pub/magento/setup/customize-your-store.js')
        ->appendFile($baseUrl . '/pub/magento/setup/create-admin-account.js')
        ->appendFile($baseUrl . '/pub/magento/setup/install.js')
        ->appendFile($this->basePath() . '/pub/magento/setup/success.js')
        ->appendFile($baseUrl . '/pub/magento/setup/create-backup.js')
        ->appendFile($baseUrl . '/pub/magento/setup/complete-backup.js')
        ->appendFile($baseUrl . '/pub/magento/setup/data-option.js')
        ->appendFile($baseUrl . '/pub/magento/setup/start-updater.js')
        ->appendFile($baseUrl . '/pub/magento/setup/updater-success.js')
        ->appendFile($baseUrl . '/pub/magento/setup/select-version.js')
        ->appendFile($baseUrl . '/pub/magento/setup/home.js')
        ->appendFile($baseUrl . '/pub/magento/setup/auth-dialog.js')
        ->appendFile($baseUrl . '/pub/magento/setup/system-config.js')
        ->appendFile($baseUrl . '/pub/magento/setup/marketplace-credentials.js')
        ->appendFile($baseUrl . '/pub/magento/setup/install-extension-grid.js');
    ?>
    <?php else: ?>
    <?= $this->headScript()
        ->appendFile($baseUrl . '/pub/angular/angular.min.js')
        ->appendFile($baseUrl . '/pub/angular-ng-storage/angular-ng-storage.min.js')
        ->appendFile($baseUrl . '/pub/angular-ng-dialog/angular-ng-dialog.min.js')
        ->appendFile($baseUrl . '/pub/angular-clickout/angular-clickout.min.js')
        ->appendFile($baseUrl . '/pub/angular-ui-router/angular-ui-router.min.js')
        ->appendFile($baseUrl . '/pub/angular-ui-bootstrap/angular-ui-bootstrap.min.js')
        ->appendFile($baseUrl . '/pub/angular-sanitize/angular-sanitize.min.js')
        ->appendFile($baseUrl . '/pub/magento/setup/app.js')
        ->appendFile($baseUrl . '/pub/magento/setup/main.js')
        ->appendFile($baseUrl . '/pub/magento/setup/landing.js')
        ->appendFile($baseUrl . '/pub/magento/setup/module-grid.js')
        ->appendFile($baseUrl . '/pub/magento/setup/extension-grid.js')
        ->appendFile($baseUrl . '/pub/magento/setup/readiness-check.js')
        ->appendFile($baseUrl . '/pub/magento/setup/add-database.js')
        ->appendFile($baseUrl . '/pub/magento/setup/web-configuration.js')
        ->appendFile($baseUrl . '/pub/magento/setup/customize-your-store.js')
        ->appendFile($baseUrl . '/pub/magento/setup/create-admin-account.js')
        ->appendFile($baseUrl . '/pub/magento/setup/install.js')
        ->appendFile($this->basePath() . '/pub/magento/setup/success.js')
        ->appendFile($baseUrl . '/pub/magento/setup/create-backup.js')
        ->appendFile($baseUrl . '/pub/magento/setup/complete-backup.js')
        ->appendFile($baseUrl . '/pub/magento/setup/data-option.js')
        ->appendFile($baseUrl . '/pub/magento/setup/start-updater.js')
        ->appendFile($baseUrl . '/pub/magento/setup/updater-success.js')
        ->appendFile($baseUrl . '/pub/magento/setup/select-version.js')
        ->appendFile($baseUrl . '/pub/magento/setup/home.js')
        ->appendFile($baseUrl . '/pub/magento/setup/auth-dialog.js')
        ->appendFile($baseUrl . '/pub/magento/setup/remove-dialog.js')
        ->appendFile($baseUrl . '/pub/magento/setup/system-config.js')
        ->appendFile($baseUrl . '/pub/magento/setup/marketplace-credentials.js')
        ->appendFile($baseUrl . '/pub/magento/setup/install-extension-grid.js')
        ->appendFile($baseUrl . '/pub/magento/setup/update-extension-grid.js');
    ?>
    <?php endif ?>
    <?php
        $url = $this->basePath();
        $url = (isset($_SERVER['HTTPS']) ? "https" : "http") . "://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";
        $url = str_replace('themesetup/','',$url);
    ?>
    <script type="text/javascript">
        var config = {
            address: {
                base_url: '',
                auto_base_url: '',
                actual_base_url: '<?php echo $url ?>',
                admin: '<?php echo $data['backend']['frontName'] ?>'
            },
            https: {
                front: false,
                admin: false,
                text: '<?php echo $url ?>'
            },
            rewrites: {
                allowed: true
            },
            encrypt: {
                key: 'null',
                type: 'magento'
            },
            advanced: {
                expanded: false
            },
            sessionSave: {
                type: 'files',
                error: false
            }
        };
        window.localStorage.setItem("ngStorage-config", JSON.stringify(config));
    </script>
    <link
        rel="icon"
        type="image/x-icon"
        href="<?php echo $baseUrl ?>/pub/images/favicon/favicon.ico"
        sizes="16x16">
    <link
        rel="icon"
        type="image/png"
        href="<?php echo $baseUrl ?>/pub/images/favicon/favicon-96x96.png"
        sizes="96x96">
    <link
        rel="icon"
        type="image/png"
        href="<?php echo $baseUrl ?>/pub/images/favicon/favicon-32x32.png"
        sizes="32x32">
    <link
        rel="icon"
        type="image/png"
        href="<?php echo $baseUrl ?>/pub/images/favicon/favicon-16x16.png"
        sizes="16x16">
    <?php echo $this->inlineScript() ?>
    <style>
        a.white-space-pre-line {
            white-space: pre-line;
        }
        .menu-wrapper{display:none;}
    </style>
</head>
<body>
<?php echo $this->content; ?>
</body>
</html>
